<!DOCTYPE html>
<html>
    <head>
        <title>RealObjects PDFreactor Migration Guide</title>
        <style>
            @-ro-preferences {
                initial-zoom: fit-page;
                page-layout: 1 column;
            }
            html {
                margin: 0;
                padding: 0;
            }
            body {
                font-size: 11pt;
                font-family: sans-serif;
                line-height: 1.5;
            }
            
            h1 {
                padding: 4pt 0;
                margin: 0;
                height: 32pt;
                
                text-align: left;
                font-size: 21pt;
                font-weight: normal;
                
                color: #ffffff;
                background-color: #003399;
            }
            
            h2 {
                margin-top: 0;
                margin-bottom: 30pt;
                font-size: 20pt;
                font-weight: bold;
                
                color: #222222;
                
                break-before: always;
            }
            
            h3 {
                margin-top: 30pt;
                margin-bottom: 10pt;
                
                font-size: 18pt;
                font-weight: normal;
                text-transform: uppercase;
                
                color: #222222;
            }
            
            h4 {
                margin-top: 20pt;
                margin-bottom: 10pt;
                
                font-size: 14pt;
                font-weight: normal;
                
                color: #222222;
                
                border-bottom: 1pt solid #e1e1e1;
            }
            
            h5 {
                -ro-bookmark-level: none;
                
                font-weight: bold;
                font-size: inherit;
                color: #000000;
                margin-bottom: 5pt;
                margin-top: 0.5cm;
            }
            
            p {
                margin-bottom: 10pt;
            }
            
            p.note {
                font-style: italic;
            }
            
            p.note::before {
                content: "Note: ";
            }
            
            code {
                font-family: monospace;
                font-size: 1.1em;
            }
            
            pre {
                background-color: #f8f8f8;
                padding: 1em;
                break-inside: avoid;
                break-before: avoid;
            }
            
            a[href] {
                color: #c20b01;
                text-decoration: none;
            }
            
            a[href]:hover {
                color: #6d0b2c;
                text-decoration: underline;
            }
            
            li {
                margin-left: 15pt;
                margin-bottom: 3pt;
            }
            
            ul, ol {
                padding-left: 0;
            }
            
            sup {
                padding-left: 3pt;
                padding-right: 3pt;
                
                font-size: 14pt;
            }
            
            del,
            .change {
                color: red;
            }
            
            /* Labeled Code Blocks */
            
            .preTitle {
                position: relative;
            }
            
            .preTitle::before, .preTitle.secCrit::after  {
                content: "To Undo";
                background-color: lightgray;
                padding: 0 0.2cm ;
                font-family: sans-serif;
                font-size: 9pt;
                position: absolute;
                top: -7pt;
                left: 4pt;
            }
            
            .preTitle.secCrit::after  {
                content: "Security Relevant";
                background-color: #feb;
                left: 60pt;
                letter-spacing: 1px;
                font-weight: bold;
            }
            
            .preTitle.titleExample::before {
                content: "Example";
                background-color: #666666;
                color: #f8f8f8;
            }
            
            .preTitle.old::before {
                content: "Legacy";
                color: darkred;
                font-size: 8pt;
            }
            
            .preTitle.new::before {
                content: "New";
                content: "PDFreactor " var(--pr-version, "New");
                color: #277927;
                font-size: 8pt;
            }
            
            /* API Change Tables */
            
            table.api-comparison {
                table-layout: fixed;
                border-collapse: collapse;
                
                min-width: 17cm;
                width: 100%;
            }
            
            table.api-comparison thead {
                text-align: center;
                font-weight: bold;
            }
            
            table.api-comparison tbody {
                break-inside: avoid;
            }
            
            table.api-comparison tbody td {
                border: 1px solid #222222;
                vertical-align: top;
                
                background-color: #f8f8f8;
            }
            
            table.api-comparison tbody td[colspan='2'] {
                text-align: center;
                
                background: lightgray;
                color: black;
            }
            
            table.api-comparison pre {
                margin: 0;
            }
            
            /* Media Styles */
            
            @media screen {
                html {
                    background-color: #f5f5f5;
                }
                body {
                    background-color: #ffffff;
                    color: #666666;
                    
                    max-width: 25cm;
                    margin: auto;
                    padding-bottom: 5%;
                    margin-bottom: 5%;
                }
                body > * {
                    padding-left: 10%;
                    padding-right: 10%;
                }
                h2 {
                    margin-top: 40pt;
                }
            }
            
            @media print {
                @page:first {
                    @top-left {
                        content: element(header);
                        background-color: #003399;
                        color:white;
                        
                        margin-left: -2cm;
                        margin-right: -2cm;
                        padding-left: 2cm;
                        padding-right: 2cm;
                    }
                
                }
                @page {
                    margin: 2cm;
                    margin-top: 2.5cm;
                    padding-top: 0.7cm;
                    font-family: sans-serif;
                    
                    @top-left {
                        content: string(title);
                        color: #003399;
                        
                        border-bottom: 1pt solid #039;
                        
                        font-size: 21pt;
                        
                        margin-top: 0.5cm;
                        margin-bottom: 0.25cm;
                    }
                    
                    @bottom-center {
                        content: "- " counter(page) " -";
                    }
                }
                
                h1 {
                    position: running(header);
                    background-color: transparent;
                    
                    string-set: title content();
                }
                
                a.internal::after {
                    content: " (page " target-counter(-ro-attr(href, url), page) ")";
                }
            }
        </style>
    </head>
    <body>
        <h1>PDFreactor Migration Guide</h1>
        
        <section style="--pr-version: '10';">
            <h2>Migrating from PDFreactor 10.0 to PDFreactor 10.1</h2>
            <section>
                <h3>Security Enhancements</h3>
                <p>PDFreactor now features configurable security behavior to prevent attacks in form of the injection of malicious code from 
                    potentially untrusted third parties that produce content which is converted by PDFreactor.</p>
                
                <h3>Updated Default Behavior</h3>
                <p>Because of the default security settings, there are some behavior changes:</p>
                <ul>
                    <li>When converting XML documents, PDFreactor will no longer automatically load external XML parser resources, such as DTDs, entities 
                        or XIncludes.</li>
                    <li>Document resources can no longer be loaded from the server's file system by default.</li>
                </ul>
                <p>Please refer to the PDFreactor manual for a detailed description of the security settings and the default behavior.</p>
                <p>You can recreate the previous unsafe behavior by using the following security settings. This also works in the 
                    deprecated legacy API. Please note that this is strongly 
                    discouraged if you process content from potentially untrusted sources.</p>
                <pre class="preTitle secCrit">config.setSecuritySettings(new SecuritySettings()
    .setAllowExternalXmlParserResources(true)
    .setDefaults(new SecurityDefaults()
        .setAllowFileSystemAccess(true)));</pre>
                
                <h4>PDFreactor Web Service</h4>
                <p>PDFreactor Web Service users can configure the security settings via server parameters. Please refer to the manual 
                    for more information.</p>
            </section>
        </section>
        
        <section style="--pr-version: '10';">
            <h2>Migrating from PDFreactor 9 to PDFreactor 10</h2>
            <section>
                <h3>Important!</h3>
                <p>PDFreactor Web Service users: If you have customized the "start.ini" file of the Jetty server, 
                    please see section <a href="#jetty10">PDFreactor Web Service Jetty</a> before installing PDFreactor 10.</p>
                <h3>Updated Default Behavior</h3>
                <h4>CSS Validation</h4>
                <p>The CSS Validator is now enabled by default. In PDFreactor 9 the validation was disabled, thus invalid values could 
                overwrite valid ones. Now with the validation enabled, invalid values are completely ignored, as if they
                were not in the style rule.</p>
                <p>To disable the Validator, use the API method <code>setCssSettings</code>:</p>
                <pre class="preTitle">config.setCssSettings(new CssSettings().setValidationMode(CssPropertySupport.ALL));</pre>
                
                <h4>Rasterization</h4>
                <p>The images that are produced when rasterizing SVGs and canvas elements have now
                a maximum size of 2 megapixels by default. If the image would be larger, the 
                resolution is reduced. This way, the used memory and the size of the resulting PDF are reduced.
                The following snippet disables this limit:</p>
                <pre class="preTitle">svg, canvas, img, object, embed {
    -ro-rasterization-max-size: none;
}</pre>
                <p>The property can also be used to increase the max-size to a certain megapixel value:</p>
                <pre class="preTitle titleExample">svg, canvas, img, object, embed {
    -ro-rasterization-max-size: 3.5;
}</pre>
                <h4>MathML</h4>
                <p>Rendering MathML now requires the import of a MathML library. We recommend <strong>MathJax</strong>, as it
                creates better results than the lib PDFreactor used in previous versions.</p>
                <p>If the input document can not be modified, the following user scripts can be defined to include and use MathJax. 
                    The first script consists of settings for the next one:</p>
                <ul>
                    <li>"roMjPath" must be set to the URL or path to the file MathJax.js, excluding the filename itself.</li>
                    <li>"roMjFile" specifies the name of the main MathJax file. It should should usually be left default.</li>
                    <li>"roMjSvgBlacker" allows to optionally increase the thickness of the fonts used by MathJax.</li>
                </ul>
                <p>Please see the comments in the snippet for example values:</p>
                
                <pre>roMjPath = "";              // default: "",
                            // examples: "MathJax/", "../../resource/js/mathjax/",
                            // "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/"
roMjFile = "MathJax.js";    // default: "MathJax.js",
                            // examples: "mathjax.js", "mathjaxmod.js"
roMjSvgBlacker = 0;         // default: 0,
                            // examples: 1, 2</pre>
                
                <p>The second script uses the values form the first one and inserts the required script elements into the document,
                    so MathJax is loaded and processes all "math" elements. It does not have to be modified.</p>
                
                <pre>document.documentElement.firstElementChild.insertAdjacentHTML('beforeend',
    '\u003Cscript type="text/x-mathjax-config">MathJax.Hub.Config(' +
    JSON.stringify({
        jax: ["input/MathML", "output/SVG"],
        extensions: ["mml2jax.js"],
        MathML: { extensions: ["content-mathml.js"] },
        SVG: { blacker: (typeof window.roMjSvgBlacker == "number" &&
            window.roMjSvgBlacker > 0 ? window.roMjSvgBlacker : 0) }
    }) +
    ');\u003C/script>\n' +
    '\u003Cscript type="text/javascript" src="' +
    (window.roMjPath ? window.roMjPath : "MathJax/") +
    (window.roMjPath && !(window.roMjPath + "").endsWith("/") ? "/" : "") +
    (window.roMjFile ? window.roMjFile : "MathJax.js") +
    '">\u003C/script>'
);</pre>

                <h4>text-align</h4>
                <p>As defined by the CSS3 specifications, 'text-align' is now handled as a shorthand for
                    'text-align-all' and 'text-align-last'. This means that, if
                    'text-align-last' is defined <strong>before</strong> 'text-align', the last line alignment will be overridden.</p>
                <p>This can be avoided by using 'text-align-all' instead of 'text-align'.</p>
                <p>Furthermore 'text-align-last' now also works if the paragraph has not been
                    set to 'justify'.</p>
                    
                <h4>Form Fields</h4>
                <p>The default styles for several form fields was updated to a more modern look. Authors that 
                    rely on these default styles should verify their documents. If necessary, the legacy styles 
                    can be recreated using CSS.</p>
            </section>
            
            <section>
                <h3 id="apiChanges10">API Changes</h3>
                <h4>General</h4>
                <h5>signPDF</h5>
                <p>When digitally signing a PDF using the <code>signPDF</code> configuration property, PDFreactor will now throw an exception and thus 
                    fail the conversion if the PDF could not be signed. Appropriate log entries as well as exception messages will provide 
                    information as to the reason.</p>
                
                <h4>Java (non-Web Service)</h4>
                <p>In previous versions, the "convert" methods were throwing various exceptions. In PDFreactor 10, this has bee reduced to only a single exception type&mdash;the 
                    <code>PDFreactorException</code>. Previously thrown exceptions are now wrapped in <code>PDFreactorException</code>s and are available as their cause.
                    If you are trying to catch the older exception types in your integration, you will receive compile errors.</p>
                <p>To resolve this, just remove the now superfluous catch blocks:</p>
                <pre>try {
    pdfReactor.convert(config);
} catch (PDFreactorException e) {
    // ...
<del>} catch (IOException e) {
    // ...
} catch (SAXException e) {
    // ...
} catch (TransformerException e) {
    // ...</del>
}</pre>
                <h4 id="jetty10">PDFreactor Web Service Jetty</h4>
                <p>When upgrading to PDFreactor 10 via one of the installers, an existing "start.ini" file will now always be overwritten. If you have made any changes to it, it is highly 
                    recommended that you backup these changes before installing PDFreactor 10. The installer will also do a backup of an existing "start.ini" file.</p>
                <p>From PDFreactor 10 onward, any customizations of Jetty should no longer be done in the "start.ini" file but instead in the new "main.ini"
                    and other "ini" files located in the "PDFreactor/jetty/start.d" directory.</p>
                 
                <h4>JavaScript Wrapper</h4>
                <p>The JavaScript client API was changed. Instead of using <strong>callback</strong> parameters, the API methods now return <strong>Promises</strong>.</p>
                <p>PDFreactor 9&minus; example:</p>
                <pre class="preTitle old">pdfReactor.convert(config, function(result) {
    processResult(result);
}, function(error) {
    processError(error);
});</pre>
                <p>PDFreactor 10 example:</p>
                <pre  class="preTitle new">try {
    const result = await pdfReactor.convert(config);
    processResult(result);
} catch (error) {
    processError(error);
}</pre>
                <p>For more information, please refer to the new JavaScript integration examples and the JavaScript API documentation.</p>
                
                <h4>Java Wrapper</h4>
                <ol>
                    <li>
                        <p>The class</p>
                        <pre  class="preTitle old">com.realobjects.pdfreactor.webservice.client.<span class="change">Log.LogRecord</span></pre>
                        <p>has been moved and renamed to</p>
                        <pre  class="preTitle new">com.realobjects.pdfreactor.webservice.client.<span class="change">Record</span></pre>
                    </li>
                    <li>
                        <p>All methods that returned <em>lists</em> now return <em>arrays</em> instead.</p>
                    </li>
                </ol>
                
                <h4>.NET Wrapper</h4>
                <ol>
                    <li>
                        <p>The namespace of the class</p>
                        <pre class="preTitle old">RealObjects.PDFreactor.Webservice.Client.<span class="change">Log.Record</span></pre>
                        <p>has been changed to</p>
                        <pre class="preTitle new">RealObjects.PDFreactor.Webservice.Client.<span class="change">Record</span></pre>
                    </li>
                    <li>
                        <p>The property</p>
                        <pre class="preTitle old">ExceedingContent</pre>
                        <p>of the <code>Result</code> class has been renamed to</p>
                        <pre class="preTitle new">ExceedingContent<span class="change">s</span></pre>
                    </li>
                </ol>
            </section>
            
            <section>
                    <h3 id="apiDeprecation10">Deprecated API</h3>
                    <h4>All APIs</h4>
                    <p>The configuration properties <code>appendLog</code> and <code>enableDebugMode</code> are now obsolete. Use <code>debugSettings</code> instead.</p>
                    <table class="api-comparison">
                        <col style="width: 40%;">
                        <col style="width: 60%">
                        <thead>
                            <tr>
                                <td>Old API</td>
                                <td>New API</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="2">Enabling JavaScript</td>
                            </tr>
                            <tr>
                                <td><pre>config.setJavaScriptMode(true);</pre></td>
                                <td><pre>config.setJavaScriptSettings(
  new JavaScriptSettings().setEnabled(true));</pre></td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr>
                                <td colspan="2">Enabling debug mode</td>
                            </tr>
                            <tr>
                                <td><pre>config.setEnableDebugMode(true);</pre></td>
                                <td><pre>config.setDebugSettings(
  new DebugSettings().setAll(true));</pre></td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr>
                                <td colspan="2">Appending the log</td>
                            </tr>
                            <tr>
                                <td><pre>config.setAppendLog(true);</pre></td>
                                <td><pre>config.setDebugSettings(
  new DebugSettings().setAppendLogs(true));</pre></td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr>
                                <td colspan="2">Setting resource timeout</td>
                            </tr>
                            <tr>
                                <td><pre>config.setResourceRequestTimeout(
          Integer);</pre></td>
                                <td><pre>config.setResourceReadTimeout(Integer);
config.setResourceConnectTimeout(Integer);</pre></td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr>
                                <td colspan="2">Setting a color space</td>
                            </tr>
                            <tr>
                                <td><pre>config.setDEfaultColorSpace(
  ColorSpace);</pre></td>
                                <td><pre>config.setColorSpaceSettings(
  new ColorSpaceSettings().setTargetColorSpace(
    ColorSpace));</pre></td>
                            </tr>
                        </tbody>
                    </table>
                </section>
                
                <section>
                    <h3 id="cssChanges10">CSS Changes</h3>
                    <h4>string()</h4>
                    <p>The String-function takes 2 parameters, with the second being a keyword to specify which value should be used, 
                        if there are multiple assignments for that named string on a single page.</p>
                    <p>In accordance with the CSS specifications, the identifier <code>last-except</code> has been renamed.</p>
                    <p>The keyword <code>last-except</code></p>
                    <pre class="preTitle old">content: string(namedString, last-except);</pre>
                    <p>has been replaced with <code>first-except</code></p>
                    <pre class="preTitle new">content: string(namedString, first-except);</pre>
                    <p>which has the same effect.</p>
                </section>
                
        </section>
        
        <h2>Migrating from PDFreactor 8 to PDFreactor 9</h2>
        <section>
            <h3>Updated default HTML styles</h3>
            <p>With PDFreactor 9 some of the standard HTML styles have been edited to be more in line with the HTML5 specification and modern browsers.
            While most changes are cosmetic, some will influence the layouts of existing documents. When these have a negative impact on existing 
            documents and adapting the print styles accordingly is to complex, the following snippets can be used to undo the most significant changes:</p>
            
            <h4 id="pageMargin">Page Margin</h4>
            
            <p>The default page margins were increased from 1cm to 2cm.</p>
            <pre class="preTitle">@page {
    margin: 1cm;
}</pre>
            
            <h4 id="bodyMargin">Body Margin</h4>
            
            <p>In previous versions of PDFreactor the default margins of body elements were 8px, in accordance to the HTML specification.
            As these default margins are only useful in non-paged environments they were dropped in PDFreactor 9.</p>
            <pre class="preTitle">body {
    margin: 8px;
}</pre>
            <p>For this to take effect in multi-page documents the following snippet has to be applied as well.</p>
            
            <h4 id="boxDecorationBreak">Box Decoration Break</h4>
            
            <p>The default value of the property box-decoration-break is now slice, as per the specification. The margin, padding and 
            border-width values around page break will be treated as 0.</p>
            <pre class="preTitle">* {
    box-decoration-break: clone;
}</pre>
            <h4 id="roundingMode">Rounding Mode</h4>
            
            <p>The default value of the proprietary property -ro-rounding-mode is now floor.
            This avoids rare cases where accumulated rounding imprecisions could lead to unexpected layout results,
            but may lead to different line and page-breaks.</p>
            <pre class="preTitle">html {
    -ro-rounding-mode: round;
}</pre>
            
            <h4 id="firstPageSide">First Page Side</h4>
            
            <p>The default side of first pages has changed from left to recto (i.e. right, unless the document direction is right-to-left), 
            as per the specification.</p>
            <pre class="preTitle">@-ro-preferences {
    first-page-side: left;
}</pre>
            <h4 id="marginsAfterBreaks">Margins after Breaks</h4>
            
            <p>The top margins of blocks at the start of pages and columns are no longer set to 0 for first pages and columns or after forced breaks.
            This matches the behavior of browsers and the requirements of the latest CSS specifications.</p>
            
            <pre class="preTitle">html {
    -ro-truncate-margin-after-break: always;
}</pre>
            
            <p>However, in most cases it is advisable to apply non-proprietary styles, that result in the same improvement in browsers.
            </p>
            
            <pre class="preTitle titleExample">h1 {
    break-before: page;
    margin-top: 0;
}

div.multiColumn > *:first-child {
    margin-top: 0;
}</pre>
        </section>
        
        <section>
            <h3 id="apiChanges9">API Changes</h3>
            <p>The package of the <code>ExceedingContent</code> class has been changed from</p>
            <pre>com.realobjects.pdfreactor.<span class="change">exceedingcontent</span></pre>
            <p>to</p>
            <pre>com.realobjects.pdfreactor.<span class="change">contentobserver</span></pre>
        </section>
        
        <section>
            <h3 id="apiDeprecation9">Deprecated API</h3>
            <h4>Java</h4>
            <p>The method <code>setDocument(Object)</code> is obsolete, use <code>setDocument(String)</code>, 
                <code>setDocument(byte[])</code> or <code>setDocument(InputSource)</code> instead. This only affects 
                the non-wrapper Java library.</p>
            
            <h4>Java and Java Wrapper</h4>
            <p>Constructors of inner <code>Configuration</code> classes (except for the <code>KeyValuePair</code>
                class) that take multiple arguments 
                have been deprecated and will be removed in a future version. Use the no-argument 
                constructor in conjunction with individual setters 
                instead. An exception is the <code>KeyValuePair</code> class whose multi-argument constructor is not deprecated.
                Setters now return an instance of the class, thus allowing you to chain 
                multiple subsequent setter calls. The following example demonstrates using no-argument constructors 
                and chainable setters by adding a user script and a user style sheet to a <code>Configuration</code>
                instance:</p>
            <h5>Old API</h5>
            <pre>config.setUserScripts(new ScriptResource(null, "http://myScript.js", false));
config.setUserStyleSheets(new Resource("p { color: red; }", null));</pre>
            <h5>New API</h5>
            <pre>config
    .setUserScripts(new ScriptResource().setUri("http://myScript.js"))
    .setUserStyleSheets(new Resource().setContent("p { color: red; }"));</pre>
    
            <h4>.NET Wrapper</h4>
            <p>Multi-argument constructors are now obsolete in favor of object 
                initializers.</p>
            <h5>Old API</h5>
            <pre>config.UserScripts.Add(new ScriptResource(null, "http://myScript.js", false));
config.UserStyleSheets.Add(new Resource("p { color: red; }", null));</pre>
            <h5>New API</h5>
            <pre>config.UserScripts.Add(new ScriptResource { Uri = "http://myScript.js" });
config.UserStyleSheets.Add(new Resource { Content = "p { color: red; }" });</pre>

            <h4>PHP Wrapper</h4>
            <p>The PDFreactor PHP classes are now located in the namespace 
                <code>com\realobjects\pdfreactor\webservice\client\</code>. To adjust your integration, 
                just add appropriate <code>use</code> directives like this:</p>
            <pre>use com\realobjects\pdfreactor\webservice\client\PDFreactor as PDFreactor;
use com\realobjects\pdfreactor\webservice\client\LogLevel as LogLevel;
use com\realobjects\pdfreactor\webservice\client\ViewerPreferences as ViewerPreferences;
...</pre>

            <h4>All APIs</h4>
            <p>The configuration properties <code>mergeByteArray</code>, <code>mergeByteArrays</code>, 
                <code>mergeURL</code> and <code>mergeURLs</code> are now obsolete. Use 
                <code>mergeDocuments</code> instead. Note that <code>mergeDocuments</code> takes 
                one or more <code>Resource</code> objects, 
                so you have to use the appropriate properties of that object, either 
                <code>data</code> for binary data or <code>uri</code> for URLs. Java example:</p>
            <h5>Old API</h5>
            <pre>// merge single document from binary source
config.setMergeByteArray(byteArray1);
// merge multiple documents from binary source
config.setMergeByteArrays(byteArray1, byteArray2);
// merge single document from URL source
config.setMergeByteURL(url1);
// merge multiple documents from URL source
config.setMergeByteURLs(url1, url2);</pre>
            <h5>New API</h5>
            <pre>// merge single document from binary source
config.setMergeDocuments(new Resource().setData(byteArray1));
// merge multiple documents from binary source
config.setMergeDocuments(new Resource().setData(byteArray1),
        new Resource().setData(binary2));
// merge single document from URL source
config.setMergeDocuments(new Resource().setUri(url1));
// merge multiple documents from URL source
config.setMergeDocuments(new Resource().setUri(url1),
        new Resource().setUri(url2)));</pre>
            <p>The <code>ScriptResource</code> type is now deprecated, use <code>Resource</code> instead.
                This change only affects Java and .NET APIs.</p>
        </section>
        
        <h2>Migrating from PDFreactor 8.0 to PDFreactor 8.1</h2>
        <section>
            <h3>Java and .NET wrappers</h3>
            <p>When using either the Java or .NET wrapper APIs, your integration has to be adjusted. These wrapper APIs are now 
                based on the REST API rather than the SOAP API. This was done to provide an API that is more in line with 
                the other wrapper APIs.</p>
        </section>
        <section>
            <h3>PDFreactor Web Service settings</h3>
            <p>When using the PDFreactor Web Service with custom settings in the "pdfreactorwebservice.vmoptions" file, you have to 
                migrate these settings to the "start.ini" located in the "PDFreactor/jetty" directory.</p>
            <p>If your "pdfreactorwebservice.vmoptions" looked like this</p>
            <pre>-Xmx1024m
-Djava.awt.headless=true</pre>
            <p>you have to add the lines from your "pdfreactorwebservice.vmoptions" to the end of your "start.ini" file</p>
            <pre>--exec
-Dorg.apache.cxf.Logger=org.apache.cxf.common.logging.Slf4jLogger
-Dcom.realobjects.interceptConsoleOutput=true
# old pdfreactorwebservice.vmoptions settings
-Djava.awt.headless=true
-Xmx1024m</pre>
        </section>
        <h2>Migrating from PDFreactor 7- to PDFreactor 8+</h2>
        <p>With PDFreactor 8 we are introducing the first major API change since PDFreactor 2.
            One major benefit of this change is that the new Java API is identical (with a few additions)
            to the newly introduced Java web service client API.</p>
        <section>
            <h3>Using the Legacy Java API</h3>
            <p>Java integrators can still use the old API, however we highly recommend to migrate to the new API as 
                soon as possible, since the old one will be removed in a future release of PDFreactor.
                To continue using the old legacy API, just change the package from</p>
            <pre class="small">com.realobjects.pdfreactor</pre>
            <p>to</p>
            <pre >com.realobjects.pdfreactor<span class="change">.legacy</span></pre>
        </section>
        <h3>Migrating to the New API</h3>
        <h4>The Configuration Object</h4>
        <p>The most obvious change is the introduction of the <code>Configuration</code> object. In previous versions of PDFreactor, 
            you invoked all API methods on the PDFreactor instance, however this had some disadvantages like making the 
            PDFreactor instance non-reusable. In PDFreactor 8, you just have to create one instance of PDFreactor. The instance 
            only has a few API methods, like <code>convert</code>.</p>
        <p>All settings and options are properties of the configuration and have to be set there. While most methods are the 
            same as in previous versions of PDFreactor, some have changed. For example, instead of add-methods, 
            getters are used to retrieve lists on which new entries can be added. Make sure to consult the API documentation.</p>
        <h4>Converting</h4>
        <p>To create a PDF or image, you now just have to call the <code>convert</code> method with the configuration as a
            single parameter, which also specifies the input document.
            PDFreactor automatically detects if you are converting an HTML string, a URL or binary data.</p>
        <h4>Retrieving the Result</h4>
        <p>The new <code>convert(Configuration)</code> method no longer returns the PDF as binary directly. It returns a <code>Result</code> 
            object which not only contains the PDF as binary, but also other useful data such as the log.</p>
        <p>There are additional convert methods, such as <code>convert(Configuration, OutputStream)</code> which writes 
            the PDF directly in the specified OutputStream instead of returning it or <code>convertAsBinary(Configuration)</code>
            which returns the binary data directly instead of a Result object. Please make sure to read the API documentation and
            the PDFreactor manual (Chapter "Integration").</p>
        <h3>Examples</h3>
            <p>Below are simple examples in different programming languages that show how PDFreactor 
            was used previously and how it is used now.</p>
            <ul>
                <li><a class="internal" href="#java">Java</a></li>
                <li><a class="internal" href="#dotnet">.NET</a></li>
                <li><a class="internal" href="#php">PHP</a></li>
                <li><a class="internal" href="#python">Python</a></li>
                <li><a class="internal" href="#ruby">Ruby</a></li>
                <li><a class="internal" href="#perl">Perl</a></li>
            </ul>
        <section>
            <h4 id="java">Java</h4>
            <h5>Old API</h5>
            <pre>PDFreactor pdfReactor = new PDFreactor();

// simple settings
pdfReactor.setAddBookmarks(true);
pdfReactor.setAddLinks(true);

// adding a user style sheet
pdfReactor.addUserStyleSheet("p { color: red }", null, null, null);

// create PDF and specify the document
byte[] pdf = pdfReactor.renderDocumentFromURL("https://www.realobjects.com");</pre>
            <h5>New API</h5>
            <pre>PDFreactor pdfReactor = new PDFreactor();
Configuration config = new Configuration();

// specify the document
config.setDocument("https://www.realobjects.com");

// simple settings
config.setAddBookmarks(true);
config.setAddLinks(true);

// adding a user style sheet
config.getUserStyleSheets().add(new Resource("p { color: red }", null));

// create PDF
Result result = pdfReactor.convert(config);
byte[] pdf = result.getDocument();</pre>
        </section>
        
        <section>
            <h4 id="dotnet">.NET</h4>
            <h5>Old API</h5>
            <pre>PDFreactor pdfReactor = new PDFreactor();

// simple settings
pdfReactor.SetAddBookmarks(true);
pdfReactor.SetAddLinks(true);

// adding a user style sheet
pdfReactor.AddUserStyleSheet("p { color: red }", "", "", "");

// create PDF and specify the document
byte[] pdf = pdfReactor.RenderDocumentFromURL("https://www.realobjects.com");</pre>
            <h5>New API <i style="color: #A8A8A8;">(Changed in version 8.1)</i></h5>
            <pre>PDFreactor pdfReactor = new PDFreactor();
Configuration config = Configuration();

// specify the document
config.Document = "https://www.realobjects.com";

// simple settings
config.AddBookmarks = true;
config.AddLinks = true;

// adding a user style sheet
config.UserStyleSheets = new List&lt;Resource&gt; {new Resource("p { color: red }", "")};

// create PDF
Result result = pdfReactor.Convert(config);
byte[] pdf = result.Document;</pre>
        </section>
        <section>
            <h4 id="php">PHP</h4>
            <h5>Old API</h5>
            <pre>$pdfReactor = new PDFreactor();

// simple settings
$pdfReactor->setAddBookmarks(true);
$pdfReactor->setAddLinks(true);

// adding a user style sheet
$pdfReactor->addUserStyleSheet("p { color: red }", "", "", "");

// create PDF and specify the document
$result = $pdfReactor->renderDocumentFromURL("https://www.realobjects.com");</pre>
            <h5>New API</h5>
            <pre>$pdfReactor = new PDFreactor();
$config = array(
    // specify the document
    "document" => "https://www.realobjects.com",
    
    // simple settings
    "addBookmarks" => true,
    "addLinks" => true,
    
    // adding a user style sheet
    "userStyleSheets" => array(
        array(
            "content"=> "p { color: red }"
        )
    )
);

// create PDF
// ...as base64 encoded String
$result = $pdfReactor->convert($config);
$pdf = $result->document;

// ...as binary
$pdf = $pdfReactor->convertAsBinary($config);</pre>
            <p class="note">To convert the base64 encoded document into binary data, you can do the following:</p>
            <pre>echo base64_decode($result->document);</pre>
        </section>
        <section>
            <h4 id="python">Python</h4>
            <h5>Old API</h5>
            <pre>pdfReactor = PDFreactor()

# simple settings
pdfReactor.setAddBookmarks(True)
pdfReactor.setAddLinks(True)

# adding a user style sheet
pdfReactor.addUserStyleSheet("p { color: red }", "", "", "")

# create PDF and specify the document
result = pdfReactor.renderDocumentFromURL("https://www.realobjects.com");</pre>
            <h5>New API</h5>
            <pre>pdfReactor = PDFreactor()
config = {
    # specify the document
    'document': "https://www.realobjects.com",
    
    # simple settings
    'addBookmarks': True,
    'addLinks': True,
    
    # adding a user style sheet
    'userStyleSheets': [
        {
            'content': "p { color: red }"
        }
    ]
}

# create PDF
# ...as base64 encoded String
result = pdfReactor.convert(config)
pdf = result['document']

# ...as binary
pdf = pdfReactor.convertAsBinary(config)</pre>
            <p class="note">To convert the base64 encoded document into binary data, you can do the following:</p>
            <pre>import base64
print(base64.b64decode(result['document']))</pre>
        </section>
        <section>
            <h4 id="ruby">Ruby</h4>
            <h5>Old API</h5>
            <pre>pdfReactor = PDFreactor.new();

# simple settings
pdfReactor.setAddBookmarks(true)
pdfReactor.setAddLinks(true)

# adding a user style sheet
pdfReactor.addUserStyleSheet("p { color: red }", "", "", "")

# create PDF and specify the document
result = pdfReactor.renderDocumentFromURL("https://www.realobjects.com")</pre>
            <h5>New API</h5>
            <pre>pdfReactor = PDFreactor.new()
config = {
    # specify the document
    document: "https://www.realobjects.com",
    
    # simple settings
    addBookmarks: true,
    addLinks: true,
    
    # adding a user style sheet
    userStyleSheets: [
        {
            content: "p { color: red }"
        }
    ]
}

# create PDF
# ...as base64 encoded String
result = pdfReactor.convert(config)
pdf = result["document"]

# ...as binary
pdf = pdfReactor.convertAsBinary(config)</pre>
            <p class="note">To convert the base64 encoded document into binary data, you can do the following:</p>
            <pre>require "base64"
print Base64.decode64(result["document"])</pre>
        </section>
        <section>
            <h4 id="perl">Perl</h4>
            <h5>Old API</h5>
            <pre>my $pdfReactor = PDFreactor -> new();

# simple settings
$pdfReactor -> setAddBookmarks('true');
$pdfReactor -> setAddLinks('true');

# adding a user style sheet
$pdfReactor -> addUserStyleSheet("p { color: red }", "", "", "");

# create PDF and specify the document
$result = pdfReactor -> renderDocumentFromURL("https://www.realobjects.com");</pre>
            <h5>New API</h5>
            <pre>my $pdfReactor = PDFreactor -> new();
$config = {
    # specify the document
    'document' => "https://www.realobjects.com",
    
    # simple settings
    'addBookmarks' => 'true',
    'addLinks' => 'true',
    
    # adding a user style sheet
    'userStyleSheets' => [
        {
            'content' => "p { color: red }"
        }
    ]
};

# create PDF
# ...as base64 encoded String
$result = $pdfReactor -> convert($config);
$pdf = $result->{'document'};

# ...as binary
$pdf = $pdfReactor -> convertAsBinary($config);</pre>
            <p class="note">To convert the base64 encoded document into binary data, you can do the following:</p>
            <pre>use MIME::Base64 ();
print MIME::Base64::decode($result->{'document'});</pre>
        </section>
    </body>
</html>
